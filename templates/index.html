<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="One_Blink - SOC Intelligence Framework for Network Forensics">
    <title>◈ One_Blink - SOC Intelligence Framework</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/static/css/dashboard.css">

    <style>
        /* Upload Page Specific Styles */
        .upload-container {
            max-width: 800px;
            margin: 4rem auto;
        }

        .drop-zone {
            border: 3px dashed var(--primary);
            border-radius: 1rem;
            padding: 4rem 2rem;
            text-align: center;
            background: rgba(102, 126, 234, 0.05);
            transition: all var(--transition-normal);
            cursor: pointer;
        }

        .drop-zone:hover,
        .drop-zone.drag-over {
            background: rgba(102, 126, 234, 0.1);
            border-color: var(--secondary);
            transform: scale(1.02);
        }

        .drop-icon {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: var(--spacing-lg);
        }

        .upload-options {
            margin: var(--spacing-2xl) 0;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            cursor: pointer;
            padding: var(--spacing-md);
            background: white;
            border-radius: 0.5rem;
            transition: all var(--transition-fast);
        }

        .checkbox-label:hover {
            background: var(--light);
        }

        .checkbox-label input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .file-info {
            margin: var(--spacing-lg) 0;
            padding: var(--spacing-md);
            background: var(--light);
            border-radius: 0.5rem;
            display: none;
        }

        .file-info.active {
            display: block;
        }

        .progress-container {
            margin: var(--spacing-lg) 0;
            display: none;
        }

        .progress-container.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: var(--gray-light);
            border-radius: 1rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            width: 0%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">◈</span>
                    <div>
                        <div>One_Blink</div>
                        <div class="tagline">SOC Intelligence Framework</div>
                    </div>
                </div>

                <nav>
                    <ul class="nav">
                        <li><a href="/" class="nav-link active">Upload</a></li>
                        <li><a href="/dashboard" class="nav-link">Dashboard</a></li>
                        <li><a href="/reports" class="nav-link">Reports</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <div class="upload-container fade-in">
            <div class="card">
                <div class="card-header">
                    <h1 class="card-title text-center">◈ PCAP Analysis</h1>
                    <p class="text-center text-muted">Upload network capture for forensic analysis</p>
                </div>

                <!-- Drop Zone -->
                <div class="drop-zone" id="dropZone">
                    <div class="drop-icon">[PCAP]</div>
                    <h2>Drop PCAP file here</h2>
                    <p class="text-muted">or click to browse</p>
                    <p class="text-muted mt-2"><small>Supported formats: .pcap, .pcapng (Max: 500MB)</small></p>
                    <input type="file" id="fileInput" accept=".pcap,.pcapng" style="display: none;">
                </div>

                <!-- File Info -->
                <div class="file-info" id="fileInfo">
                    <h3>Selected File</h3>
                    <p><strong>Name:</strong> <span id="fileName"></span></p>
                    <p><strong>Size:</strong> <span id="fileSize"></span></p>
                    <p><strong>Type:</strong> <span id="fileType"></span></p>
                </div>

                <!-- Analysis Options -->
                <div class="upload-options">
                    <h3>Analysis Options</h3>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="enableZeek" checked>
                            <span>
                                <strong>Enable Zeek Enrichment</strong>
                                <br>
                                <small class="text-muted">Session tracking, service identification, UID
                                    correlation</small>
                            </span>
                        </label>

                        <label class="checkbox-label">
                            <input type="checkbox" id="enableSnort" checked>
                            <span>
                                <strong>Enable Snort IDS</strong>
                                <br>
                                <small class="text-muted">4,017 community rules for threat detection</small>
                            </span>
                        </label>

                        <label class="checkbox-label">
                            <input type="checkbox" id="enableAI" checked>
                            <span>
                                <strong>Generate AI Analysis Report</strong>
                                <br>
                                <small class="text-muted">14-section enterprise report with 75/25 threat scoring</small>
                            </span>
                        </label>
                    </div>
                </div>

                <!-- Progress Bar -->
                <div class="progress-container" id="progressContainer">
                    <h3>Processing...</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill">0%</div>
                    </div>
                    <p class="text-muted mt-2" id="progressStatus">Initializing...</p>
                </div>

                <!-- Submit Button -->
                <div class="text-center mt-4">
                    <button class="btn btn-primary" id="analyzeBtn" disabled>
                        Analyze PCAP
                    </button>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="metric-grid mt-4">
                <div class="metric-card">
                    <div class="metric-label">TShark Version</div>
                    <div class="metric-value">4.2.2</div>
                    <div class="metric-change">✓ Ready</div>
                </div>

                <div class="metric-card">
                    <div class="metric-label">Zeek Engine</div>
                    <div class="metric-value">8.1.0</div>
                    <div class="metric-change">✓ Operational</div>
                </div>

                <div class="metric-card">
                    <div class="metric-label">Snort IDS</div>
                    <div class="metric-value">3.10</div>
                    <div class="metric-change">✓ 4,017 Rules</div>
                </div>

                <div class="metric-card">
                    <div class="metric-label">AI Models</div>
                    <div class="metric-value">Ready</div>
                    <div class="metric-change">✓ LLM Active</div>
                </div>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script src="/static/js/upload.js"></script>
</body>

</html>